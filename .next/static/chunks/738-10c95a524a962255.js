(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[738],{3878:function(r){function e(r){var e=new Error("Cannot find module '"+r+"'");throw e.code="MODULE_NOT_FOUND",e}e.keys=function(){return[]},e.resolve=e,e.id=3878,r.exports=e},8246:function(r,e,t){"use strict";t.d(e,{Z:function(){return Z}});var n=t(7568),o=t(1799),a=t(9396),i=t(7582),s=t(5893),u=t(781),c=t(5675),l=t.n(c),f=t(7533),d=t(7536),p=t(6310),h=t(7294),m=t(7066),_=t(8828),b=t(1237),v=t.n(b),g=t(6940),x=t(1877),y=t(1163);function w(r){return E.apply(this,arguments)}function E(){return(E=(0,n.Z)((function(r){var e,t;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:(e=new FormData).append("file",r),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,m.Z.post("".concat(_.JW,"/api/cloudinary/upload"),e,{headers:{"Content-Type":"multipart/form-data"}})];case 2:return[2,n.sent().data.secure_url];case 3:throw t=n.sent(),console.error("\uc774\ubbf8\uc9c0 \uc5c5\ub85c\ub4dc \uc2e4\ud328:",t),new Error("Image upload failed");case 4:return[2]}}))}))).apply(this,arguments)}function Z(r){var e=r.book,t=r.mode,c=(0,h.useState)((null===e||void 0===e?void 0:e.image_url)||""),m=c[0],_=c[1],b=(0,y.useRouter)(),E=p.Ry().shape({title:p.Z_().required("\uc81c\ubaa9\uc744 \uc785\ub825\ud558\uc138\uc694.").max(50,"\uc81c\ubaa9\uc740 50\uc790\ub97c \ucd08\uacfc\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),sub_title:p.Z_().required("\ubd80\uc81c\ubaa9\uc744 \uc785\ub825\ud558\uc138\uc694.").max(100,"\ubd80\uc81c\ubaa9\uc740 100\uc790\ub97c \ucd08\uacfc\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),price:p.Rx().typeError("\uac00\uaca9\uc740 \uc22b\uc790\ub85c \uc785\ub825\ud574\uc57c \ud569\ub2c8\ub2e4.").required("\uac00\uaca9\uc744 \uc785\ub825\ud558\uc138\uc694.").min(0,"\uac00\uaca9\uc740 0 \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4."),author:p.Z_().required("\uc800\uc790\ub97c \uc785\ub825\ud558\uc138\uc694.").max(50,"\uc800\uc790\ub294 50\uc790\ub97c \ucd08\uacfc\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),image_url:p.Z_().required("\uc774\ubbf8\uc9c0 URL\uc744 \uc785\ub825\ud558\uc138\uc694.").url("\uc720\ud6a8\ud55c URL\uc744 \uc785\ub825\ud558\uc138\uc694."),publisher:p.Z_().required("\ucd9c\ud310\uc0ac\ub97c \uc785\ub825\ud558\uc138\uc694.").max(50,"\ucd9c\ud310\uc0ac\ub294 50\uc790\ub97c \ucd08\uacfc\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),published_date:p.Z_().required("\ucd9c\ud310\uc77c\uc740 \ud544\uc218\uc785\ub2c8\ub2e4"),sales_quantity:p.Rx().typeError("\ud310\ub9e4 \uc218\ub7c9\uc740 \uc22b\uc790\ub85c \uc785\ub825\ud574\uc57c \ud569\ub2c8\ub2e4.").required("\ud310\ub9e4 \uc218\ub7c9\uc744 \uc785\ub825\ud558\uc138\uc694.").min(0,"\ud310\ub9e4 \uc218\ub7c9\uc740 0 \uc774\uc0c1\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.")}),Z=(0,d.cI)({resolver:(0,f.X)(E),mode:"onTouched",defaultValues:e}),j=Z.register,N=Z.handleSubmit,q=Z.formState.errors,R=Z.setValue,k=function(){var r=(0,n.Z)((function(r){return(0,i.__generator)(this,(function(n){return"edit"===t?(0,x.N)("\uc815\ub9d0\ub85c \uc218\uc815\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?",(function(){(0,g.rP)(e.id,r).then((function(){window.alert("\uc218\uc815\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}))})):"create"===t&&(0,x.N)("\uc815\ub9d0\ub85c \uc0dd\uc131\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?",(function(){(0,u.IY)(r).then((function(){window.alert("\uc0dd\uc131\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}))})),b.push("/books"),[2]}))}));return function(e){return r.apply(this,arguments)}}(),T=function(){var r=(0,n.Z)((function(r){var e,t,n,o;return(0,i.__generator)(this,(function(a){switch(a.label){case 0:return(t=null===(e=r.target.files)||void 0===e?void 0:e[0])?((n=new FileReader).onload=function(){return _(n.result)},n.readAsDataURL(t),[4,w(t)]):[3,2];case 1:o=a.sent(),R("image_url",o),_(o),a.label=2;case 2:return[2]}}))}));return function(e){return r.apply(this,arguments)}}();return(0,s.jsxs)("form",{onSubmit:N(k,(function(r){r&&window.alert("\ubaa8\ub4e0 \ub0b4\uc6a9\uc744 \ucc44\uc6cc\uc8fc\uc138\uc694.")})),encType:"multipart/form-data",className:v().formWrapper,children:[(0,s.jsx)("h2",{className:v().formTitle,children:"edit"===t?"\ucc45 \uc218\uc815\ud558\uae30":"\ucc45 \ucd94\uac00\ud558\uae30"}),(0,s.jsxs)("div",{className:v().formGroup,children:[(0,s.jsx)("label",{children:"\uc81c\ubaa9"}),(0,s.jsx)("input",(0,o.Z)({type:"text"},j("title",{required:"\uc81c\ubaa9\uc740 \ud544\uc218 \ud56d\ubaa9\uc785\ub2c8\ub2e4."}))),q.title&&(0,s.jsx)("p",{className:v().formError,children:q.title.message})]}),(0,s.jsxs)("div",{className:v().formGroup,children:[(0,s.jsx)("label",{children:"\ubd80\uc81c\ubaa9"}),(0,s.jsx)("input",(0,o.Z)({type:"text"},j("sub_title",{required:"\ubd80\uc81c\ubaa9\uc740 \ud544\uc218 \ud56d\ubaa9\uc785\ub2c8\ub2e4."}))),q.sub_title&&(0,s.jsx)("p",{className:v().formError,children:q.sub_title.message})]}),(0,s.jsxs)("div",{className:v().formGroup,children:[(0,s.jsx)("label",{children:"\uac00\uaca9"}),(0,s.jsx)("input",(0,o.Z)({type:"number"},j("price",{required:"\uac00\uaca9\uc744 \uc785\ub825\ud558\uc138\uc694."}))),q.price&&(0,s.jsx)("p",{className:v().formError,children:q.price.message})]}),(0,s.jsxs)("div",{className:v().formGroup,children:[(0,s.jsx)("label",{children:"\uc800\uc790"}),(0,s.jsx)("input",(0,o.Z)({type:"text"},j("author",{required:"\uc800\uc790\ub97c \uc785\ub825\ud558\uc138\uc694."}))),q.author&&(0,s.jsx)("p",{className:v().formError,children:q.author.message})]}),(0,s.jsxs)("div",{className:v().formGroup,children:[m.includes("http")&&(0,s.jsx)(l(),{src:m,alt:"book_img",width:350,height:400,className:v().previewImage}),(0,s.jsx)("label",{htmlFor:"image_url",children:"\uc774\ubbf8\uc9c0 URL \ub610\ub294 \ud30c\uc77c \uc5c5\ub85c\ub4dc"}),(0,s.jsx)("input",(0,a.Z)((0,o.Z)({type:"text"},j("image_url")),{placeholder:"\uc774\ubbf8\uc9c0 URL \uc785\ub825"})),q.image_url&&(0,s.jsx)("p",{className:v().formError,children:q.image_url.message}),(0,s.jsx)("input",(0,a.Z)((0,o.Z)({type:"file",accept:"image/png, image/jpeg",id:"image_url",name:"image_url"},j("image_url")),{onChange:T})),q.image_url&&(0,s.jsx)("p",{className:v().formError,children:q.image_url.message})]}),(0,s.jsxs)("div",{className:v().formGroup,children:[(0,s.jsx)("label",{children:"\ucd9c\ud310\uc0ac"}),(0,s.jsx)("input",(0,o.Z)({type:"text"},j("publisher",{required:"\ucd9c\ud310\uc0ac\ub97c \uc785\ub825\ud558\uc138\uc694."}))),q.publisher&&(0,s.jsx)("p",{className:v().formError,children:q.publisher.message})]}),(0,s.jsxs)("div",{className:v().formGroup,children:[(0,s.jsx)("label",{children:"\ucd9c\ud310\uc77c"}),(0,s.jsx)("input",(0,o.Z)({type:"date"},j("published_date",{required:"\ucd9c\ud310\uc77c\uc744 \uc785\ub825\ud558\uc138\uc694."}))),q.published_date&&(0,s.jsx)("p",{className:v().formError,children:q.published_date.message})]}),(0,s.jsxs)("div",{className:v().formGroup,children:[(0,s.jsx)("label",{children:"\ud310\ub9e4 \uc218\ub7c9"}),(0,s.jsx)("input",(0,o.Z)({type:"number"},j("sales_quantity",{required:"\ud310\ub9e4 \uc218\ub7c9\uc744 \uc785\ub825\ud558\uc138\uc694."}))),q.sales_quantity&&(0,s.jsx)("p",{className:v().formError,children:q.sales_quantity.message})]}),(0,s.jsxs)("div",{className:v().formButtons,children:[(0,s.jsx)("button",{type:"button",className:v().cancelBtn,onClick:function(){window.history.back()},children:"\ucde8\uc18c"}),(0,s.jsx)("button",{type:"submit",className:v().submitBtn,children:"edit"===t?"\uc218\uc815":"\uc0dd\uc131"})]})]})}},8828:function(r,e,t){"use strict";t.d(e,{JW:function(){return l}});var n=t(7568),o=t(828),a=t(7582),i=t(7484),s=t.n(i),u=t(4491),c=t(3454),l="http://localhost:3000",f=u.createPool({host:c.env.DB_HOST,user:c.env.DB_USER,password:c.env.DB_PASSWORD,database:c.env.DB_NAME,port:3306});(function(){var r=(0,n.Z)((function(r){var e,t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,f.query(r)];case 1:return e=o.Z.apply(void 0,[n.sent(),1]),[2,e[0]];case 2:throw t=n.sent(),console.error("MySQL query error: ",t),new Error("Database query failed");case 3:return[2]}}))}))})(),function(){var r=(0,n.Z)((function(r){var e,t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return e="SELECT * FROM books WHERE id > ".concat(10*r-10," LIMIT 10"),[4,f.query(e)];case 1:return t=o.Z.apply(void 0,[n.sent(),1]),[2,t[0]]}}))}))}(),function(){var r=(0,n.Z)((function(){var r;return(0,a.__generator)(this,(function(e){switch(e.label){case 0:return"SELECT COUNT(*) as total_count FROM books",[4,f.query("SELECT COUNT(*) as total_count FROM books")];case 1:return r=o.Z.apply(void 0,[e.sent(),1]),[2,r[0][0].total_count]}}))}))}(),function(){var r=(0,n.Z)((function(r){var e,t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return e="SELECT * FROM books WHERE id = ".concat(r),[4,f.query(e)];case 1:return t=o.Z.apply(void 0,[n.sent(),1]),[2,t[0][0]]}}))}))}(),function(){var r=(0,n.Z)((function(r,e){var t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return t="\n    UPDATE books \n    SET \n        title = '".concat(e.title,"',\n        sub_title = '").concat(e.sub_title,"',\n        price = ").concat(e.price,",\n        author = '").concat(e.author,"',\n        image_url = '").concat(e.image_url,"',\n        publisher = '").concat(e.publisher,"',\n        published_date = '").concat(s()(e.published_date).format("YYYY-MM-DD"),"',\n        sales_quantity = ").concat(e.sales_quantity," \n    WHERE id = ").concat(r),[4,f.query(t)];case 1:return n.sent(),[2]}}))}))}(),function(){var r=(0,n.Z)((function(r){var e,t,n;return(0,a.__generator)(this,(function(o){switch(o.label){case 0:e="\n      INSERT INTO books (title, sub_title, price, author, image_url, publisher, published_date, sales_quantity)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?)\n    ",t=[r.title,r.sub_title,r.price,r.author,r.image_url,r.publisher,r.published_date,r.sales_quantity],o.label=1;case 1:return o.trys.push([1,3,,4]),[4,f.query(e,t)];case 2:return o.sent(),[3,4];case 3:throw n=o.sent(),console.error("\ucc45 \uc0dd\uc131 \uc624\ub958:",n),n;case 4:return[2]}}))}))}(),function(){var r=(0,n.Z)((function(r){var e,t,n;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:e="DELETE FROM books WHERE id = ".concat(r),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,f.query(e)];case 2:if(t=o.Z.apply(void 0,[a.sent(),1]),0===t[0].affectedRows)throw new Error("\ucc45\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");return[3,4];case 3:throw n=a.sent(),console.error("\ucc45 \uc0ad\uc81c \uc624\ub958:",n),n;case 4:return[2]}}))}))}()},6940:function(r,e,t){"use strict";t.d(e,{G7:function(){return a},TS:function(){return s},rP:function(){return i}});var n=t(8828),o=t(7066);var a=function(r){return o.Z.get("".concat(n.JW,"/api/books/").concat(r)).then((function(r){return r.data})).catch((function(r){throw console.error(r),new Error("\ucc45 \uc815\ubcf4\ub97c \uac00\uc838\uc624\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}))},i=function(r,e){return o.Z.put("".concat(n.JW,"/api/books/").concat(r),e).then((function(r){window.confirm("\uc218\uc815\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),r.data})).catch((function(r){throw console.error(r),new Error("\ucc45 \uc815\ubcf4 \uc5c5\ub370\uc774\ud2b8\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}))},s=function(r){return o.Z.delete("".concat(n.JW,"/api/books/").concat(r)).then((function(r){return r.data})).catch((function(r){throw console.error(r),new Error("\ucc45\uc744 \uc0ad\uc81c\ud558\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}))}},781:function(r,e,t){"use strict";t.d(e,{IY:function(){return u},yZ:function(){return s}});var n=t(7568),o=t(7582),a=t(8828),i=t(7066);var s=function(){var r=(0,n.Z)((function(r){return(0,o.__generator)(this,(function(e){return[2,i.Z.get("".concat(a.JW,"/api/books?page=").concat(r)).then((function(r){return r.data})).catch((function(r){throw console.error(r),new Error("\ubaa9\ub85d\uc744 \uac00\uc838\uc624\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}))]}))}));return function(e){return r.apply(this,arguments)}}(),u=function(){var r=(0,n.Z)((function(r){return(0,o.__generator)(this,(function(e){return[2,i.Z.post("".concat(a.JW,"/api/books"),r).then((function(r){}))]}))}));return function(e){return r.apply(this,arguments)}}()},1877:function(r,e,t){"use strict";t.d(e,{N:function(){return n}});var n=function(){var r,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:" ",t=arguments.length>1?arguments[1]:void 0;if("function"===typeof t){var n=function(){window.confirm(e)?(t(),r=!0):r=!1};return n(),r}}},1237:function(r){r.exports={formWrapper:"form_formWrapper__cNlD9",formTitle:"form_formTitle__AwdkR",formGroup:"form_formGroup__UC2iV",formError:"form_formError__aixgf",formButtons:"form_formButtons__6ccNJ",cancelBtn:"form_cancelBtn__b9ZJT",submitBtn:"form_submitBtn__QOo4g",previewImage:"form_previewImage__CJgV3"}},5832:function(){}}]);