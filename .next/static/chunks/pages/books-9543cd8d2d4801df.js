(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[672],{3878:function(n){function t(n){var t=new Error("Cannot find module '"+n+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=function(){return[]},t.resolve=t,t.id=3878,n.exports=t},3021:function(n,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/books",function(){return r(5964)}])},8828:function(n,t,r){"use strict";r.d(t,{JW:function(){return l}});var e=r(7568),o=r(828),a=r(7582),c=r(7484),i=r.n(c),u=r(4491),s=r(3454),l="http://localhost:3000",_=u.createPool({host:s.env.DB_HOST,user:s.env.DB_USER,password:s.env.DB_PASSWORD,database:s.env.DB_NAME,port:3306});(function(){var n=(0,e.Z)((function(n){var t,r;return(0,a.__generator)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,_.query(n)];case 1:return t=o.Z.apply(void 0,[e.sent(),1]),[2,t[0]];case 2:throw r=e.sent(),console.error("MySQL query error: ",r),new Error("Database query failed");case 3:return[2]}}))}))})(),function(){var n=(0,e.Z)((function(n){var t,r;return(0,a.__generator)(this,(function(e){switch(e.label){case 0:return t="SELECT * FROM books WHERE id > ".concat(10*n-10," LIMIT 10"),[4,_.query(t)];case 1:return r=o.Z.apply(void 0,[e.sent(),1]),[2,r[0]]}}))}))}(),function(){var n=(0,e.Z)((function(){var n;return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return"SELECT COUNT(*) as total_count FROM books",[4,_.query("SELECT COUNT(*) as total_count FROM books")];case 1:return n=o.Z.apply(void 0,[t.sent(),1]),[2,n[0][0].total_count]}}))}))}(),function(){var n=(0,e.Z)((function(n){var t,r;return(0,a.__generator)(this,(function(e){switch(e.label){case 0:return t="SELECT * FROM books WHERE id = ".concat(n),[4,_.query(t)];case 1:return r=o.Z.apply(void 0,[e.sent(),1]),[2,r[0][0]]}}))}))}(),function(){var n=(0,e.Z)((function(n,t){var r;return(0,a.__generator)(this,(function(e){switch(e.label){case 0:return r="\n    UPDATE books \n    SET \n        title = '".concat(t.title,"',\n        sub_title = '").concat(t.sub_title,"',\n        price = ").concat(t.price,",\n        author = '").concat(t.author,"',\n        image_url = '").concat(t.image_url,"',\n        publisher = '").concat(t.publisher,"',\n        published_date = '").concat(i()(t.published_date).format("YYYY-MM-DD"),"',\n        sales_quantity = ").concat(t.sales_quantity," \n    WHERE id = ").concat(n),[4,_.query(r)];case 1:return e.sent(),[2]}}))}))}(),function(){var n=(0,e.Z)((function(n){var t,r,e;return(0,a.__generator)(this,(function(o){switch(o.label){case 0:t="\n      INSERT INTO books (title, sub_title, price, author, image_url, publisher, published_date, sales_quantity)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?)\n    ",r=[n.title,n.sub_title,n.price,n.author,n.image_url,n.publisher,n.published_date,n.sales_quantity],o.label=1;case 1:return o.trys.push([1,3,,4]),[4,_.query(t,r)];case 2:return o.sent(),[3,4];case 3:throw e=o.sent(),console.error("\ucc45 \uc0dd\uc131 \uc624\ub958:",e),e;case 4:return[2]}}))}))}(),function(){var n=(0,e.Z)((function(n){var t,r,e;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:t="DELETE FROM books WHERE id = ".concat(n),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,_.query(t)];case 2:if(r=o.Z.apply(void 0,[a.sent(),1]),0===r[0].affectedRows)throw new Error("\ucc45\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");return[3,4];case 3:throw e=a.sent(),console.error("\ucc45 \uc0ad\uc81c \uc624\ub958:",e),e;case 4:return[2]}}))}))}()},6940:function(n,t,r){"use strict";r.d(t,{G7:function(){return a},TS:function(){return i},rP:function(){return c}});var e=r(8828),o=r(7066);var a=function(n){return o.Z.get("".concat(e.JW,"/api/books/").concat(n)).then((function(n){return n.data})).catch((function(n){throw console.error(n),new Error("\ucc45 \uc815\ubcf4\ub97c \uac00\uc838\uc624\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}))},c=function(n,t){return o.Z.put("".concat(e.JW,"/api/books/").concat(n),t).then((function(n){window.confirm("\uc218\uc815\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4."),n.data})).catch((function(n){throw console.error(n),new Error("\ucc45 \uc815\ubcf4 \uc5c5\ub370\uc774\ud2b8\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}))},i=function(n){return o.Z.delete("".concat(e.JW,"/api/books/").concat(n)).then((function(n){return n.data})).catch((function(n){throw console.error(n),new Error("\ucc45\uc744 \uc0ad\uc81c\ud558\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}))}},781:function(n,t,r){"use strict";r.d(t,{IY:function(){return u},yZ:function(){return i}});var e=r(7568),o=r(7582),a=r(8828),c=r(7066);var i=function(){var n=(0,e.Z)((function(n){return(0,o.__generator)(this,(function(t){return[2,c.Z.get("".concat(a.JW,"/api/books?page=").concat(n)).then((function(n){return n.data})).catch((function(n){throw console.error(n),new Error("\ubaa9\ub85d\uc744 \uac00\uc838\uc624\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.")}))]}))}));return function(t){return n.apply(this,arguments)}}(),u=function(){var n=(0,e.Z)((function(n){return(0,o.__generator)(this,(function(t){return[2,c.Z.post("".concat(a.JW,"/api/books"),n).then((function(n){}))]}))}));return function(t){return n.apply(this,arguments)}}()},5964:function(n,t,r){"use strict";r.r(t),r.d(t,{__N_SSP:function(){return k},default:function(){return x}});var e=r(5893),o=r(8767),a=r(2142),c=r(8845),i=r.n(c),u=r(8804),s=r(5675),l=r.n(s),_=r(1664),f=r.n(_);function h(n){var t=n.book;return(0,e.jsx)(f(),{href:"/books/".concat(t.id),children:(0,e.jsxs)("article",{className:i().item_container,children:[(0,e.jsx)(l(),{src:"".concat(t.image_url),alt:"book_img",width:100,height:100,loading:"lazy"}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h4",{children:t.title}),(0,e.jsxs)("p",{children:[t.author," \xb7 ",(0,u.p)(new Date(t.published_date))]}),(0,e.jsxs)("p",{children:[t.price.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),"\uc6d0"]}),(0,e.jsxs)("p",{children:["\ud310\ub9e4\uc218\ub7c9 : ",t.sales_quantity,"\uad8c"]})]})]})})}function d(n){var t=n.books;return(0,e.jsx)("section",{className:i().books_container,children:(0,e.jsx)("div",{className:i().books_grid,children:t.map((function(n){return(0,e.jsx)(h,{book:n},n.id)}))})})}var p=r(943);var b=r(3375);var v=r(1566);function g(n){return function(n){if(Array.isArray(n))return(0,p.Z)(n)}(n)||(0,b.Z)(n)||(0,v.Z)(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var y=r(7294),E=r(1712),m=r.n(E);function w(n){var t=n.totalItems,r=n.itemCountPerPage,o=n.pageCount,a=n.currentPage,c=Math.ceil(t/r),i=(0,y.useState)(1),u=i[0],s=i[1],l=1===u,_=u+o-1>=c;return(0,y.useEffect)((function(){a===u+o&&s((function(n){return n+o})),a<u&&s((function(n){return n-o}))}),[a,o,u]),(0,e.jsxs)("div",{className:m().wrapper,children:[(0,e.jsx)("div",{className:"".concat(m().move," ").concat(l&&m().invisible),children:(0,e.jsx)(f(),{href:"?page=".concat(u-1),children:"\uc774\uc804"})}),(0,e.jsx)(e.Fragment,{children:g(Array(o)).map((function(n,t){return u+t<=c&&(0,e.jsx)("li",{className:m().li_margin,children:(0,e.jsx)(f(),{className:"".concat(m().page," ").concat(a===u+t&&m().active),href:"?page=".concat(u+t),children:u+t})},t)}))}),(0,e.jsx)("div",{className:"".concat(m().move," ").concat(_&&m().invisible),children:(0,e.jsx)(f(),{href:"?page=".concat(u+o),children:"\ub2e4\uc74c"})})]})}var k=!0,x=function(n){var t=n.dehydratedState,r=n.page,c=n.total,i=(0,a.lB)(r).data;return(0,e.jsxs)(o.Hydrate,{state:t,children:[(0,e.jsx)(f(),{href:"/books/create",children:(0,e.jsx)("button",{children:"\ucd94\uac00\ud558\uae30"})}),i&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(d,{books:i}),(0,e.jsx)(w,{totalItems:c,itemCountPerPage:10,pageCount:5,currentPage:r})]})]})}},8804:function(n,t,r){"use strict";r.d(t,{p:function(){return a}});var e=r(7484),o=r.n(e),a=function(n){return o()(n).format("YYYY\ub144 MM\uc6d4 DD\uc77c")}},2142:function(n,t,r){"use strict";r.d(t,{lB:function(){return c},ll:function(){return i}});var e=r(781),o=r(6940),a=r(8767),c=function(n){return(0,a.useQuery)({queryKey:["QUERY_BOOKS_KEY",{page:n}],queryFn:function(){return(0,e.yZ)(n)},keepPreviousData:!0})},i=function(n){return(0,a.useQuery)({queryKey:["QUERY_BOOK_DETAIL_KEY",{id:n}],queryFn:function(){return(0,o.G7)(n)}})}},8845:function(n){n.exports={books_container:"books_books_container__MESel",books_grid:"books_books_grid__9tXbj",item_container:"books_item_container__yZya2"}},1712:function(n){n.exports={wrapper:"pagination_wrapper__VeffM",page:"pagination_page__EkVkV",icon:"pagination_icon__9IPm_",move:"pagination_move__MyfNS",li_margin:"pagination_li_margin__xiO4E",invisible:"pagination_invisible__mG0t_",active:"pagination_active__BkigM"}},5832:function(){}},function(n){n.O(0,[714,834,555,918,774,888,179],(function(){return t=3021,n(n.s=t);var t}));var t=n.O();_N_E=t}]);